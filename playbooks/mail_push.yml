---
- name: Mail Push
  gather_facts: no
  hosts: localhost
  tasks:
  - name: zip the config files
    archive:
      path: "{{ playbook_dir }}/{{ start_time }}"
      dest: "{{ playbook_dir }}/{{ start_time }}.zip"
      format: zip
    delegate_to: localhost
    
  - name: Email when complete
    mail:
      host: imap.gmail.com
      port: 993
      username: jake.richman95@gmail.com
      password: 1qaz2wsx!QAZ@WSX1
      to: "{{ user_email }}"
      subject: complete configs for "{{ kit_number | join(", ")}}"
      body: 'congrats, it worked biatch'
      secure: try
    delegate_to: localhost
